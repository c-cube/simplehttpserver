<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Tiny_httpd_dir (tiny_httpd.Tiny_httpd_dir)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">tiny_httpd</a> &#x00BB; Tiny_httpd_dir</nav><h1>Module <code>Tiny_httpd_dir</code></h1><p>Serving static content from directories</p><p>This module provides the same functionality as the &quot;http_of_dir&quot; tool. It exposes a directory (and its subdirectories), with the optional ability to delete or upload files.</p><dl><dt>since</dt><dd>0.11</dd></dl></header><dl><dt class="spec type" id="type-dir_behavior"><a href="#type-dir_behavior" class="anchor"></a><code><span class="keyword">type</span> dir_behavior</code><code> = </code><table class="variant"><tr id="type-dir_behavior.Index" class="anchored"><td class="def constructor"><a href="#type-dir_behavior.Index" class="anchor"></a><code>| </code><code><span class="constructor">Index</span></code></td><td class="doc"><p>Redirect to index.html if present, else fails.</p></td></tr><tr id="type-dir_behavior.Lists" class="anchored"><td class="def constructor"><a href="#type-dir_behavior.Lists" class="anchor"></a><code>| </code><code><span class="constructor">Lists</span></code></td><td class="doc"><p>Lists content of directory. Be careful of security implications.</p></td></tr><tr id="type-dir_behavior.Index_or_lists" class="anchored"><td class="def constructor"><a href="#type-dir_behavior.Index_or_lists" class="anchor"></a><code>| </code><code><span class="constructor">Index_or_lists</span></code></td><td class="doc"><p>Redirect to index.html if present and lists content otherwise. This is useful for tilde (&quot;~&quot;) directories and other per-user behavior, but be mindful of security implications</p></td></tr><tr id="type-dir_behavior.Forbidden" class="anchored"><td class="def constructor"><a href="#type-dir_behavior.Forbidden" class="anchor"></a><code>| </code><code><span class="constructor">Forbidden</span></code></td><td class="doc"><p>Forbid access to directory. This is suited for serving assets, for example.</p></td></tr></table></dt><dd><p>behavior of static directory.</p><p>This controls what happens when the user requests the path to a directory rather than a file.</p></dd></dl><dl><dt class="spec type" id="type-hidden"><a href="#type-hidden" class="anchor"></a><code><span class="keyword">type</span> hidden</code></dt><dd><p>Type used to prevent users from building a config directly. Use <a href="index.html#val-default_config"><code>default_config</code></a> or <a href="index.html#type-config"><code>config</code></a> instead.</p></dd></dl><dl><dt class="spec type" id="type-config"><a href="#type-config" class="anchor"></a><code><span class="keyword">type</span> config</code><code> = </code><code>{</code><table class="record"><tr id="type-config.download" class="anchored"><td class="def field"><a href="#type-config.download" class="anchor"></a><code><span class="keyword">mutable</span> download : bool;</code></td><td class="doc"><p>Is downloading files allowed?</p></td></tr><tr id="type-config.dir_behavior" class="anchored"><td class="def field"><a href="#type-config.dir_behavior" class="anchor"></a><code><span class="keyword">mutable</span> dir_behavior : <a href="index.html#type-dir_behavior">dir_behavior</a>;</code></td><td class="doc"><p>Behavior when serving a directory and not a file</p></td></tr><tr id="type-config.delete" class="anchored"><td class="def field"><a href="#type-config.delete" class="anchor"></a><code><span class="keyword">mutable</span> delete : bool;</code></td><td class="doc"><p>Is deleting a file allowed? (with method DELETE)</p></td></tr><tr id="type-config.upload" class="anchored"><td class="def field"><a href="#type-config.upload" class="anchor"></a><code><span class="keyword">mutable</span> upload : bool;</code></td><td class="doc"><p>Is uploading a file allowed? (with method PUT)</p></td></tr><tr id="type-config.max_upload_size" class="anchored"><td class="def field"><a href="#type-config.max_upload_size" class="anchor"></a><code><span class="keyword">mutable</span> max_upload_size : int;</code></td><td class="doc"><p>If <a href="index.html#type-config.upload"><code>upload</code></a> is true, this is the maximum size in bytes for uploaded files.</p></td></tr><tr id="type-config._rest" class="anchored"><td class="def field"><a href="#type-config._rest" class="anchor"></a><code>_rest : <a href="index.html#type-hidden">hidden</a>;</code></td><td class="doc"><p>Just ignore this field.</p></td></tr></table><code>}</code></dt><dd><p>configuration for static file handlers. This might get more fields over time.</p></dd></dl><dl><dt class="spec value" id="val-default_config"><a href="#val-default_config" class="anchor"></a><code><span class="keyword">val</span> default_config : unit <span>&#45;&gt;</span> <a href="index.html#type-config">config</a></code></dt><dd><p>default configuration: <code>
  { download=true
  ; dir_behavior=Forbidden
  ; delete=false
  ; upload=false
  ; max_upload_size = 10 * 1024 * 1024
  }</code></p></dd></dl><dl><dt class="spec value" id="val-config"><a href="#val-config" class="anchor"></a><code><span class="keyword">val</span> config : <span>?&#8288;download:bool</span> <span>&#45;&gt;</span> <span>?&#8288;dir_behavior:<a href="index.html#type-dir_behavior">dir_behavior</a></span> <span>&#45;&gt;</span> <span>?&#8288;delete:bool</span> <span>&#45;&gt;</span> <span>?&#8288;upload:bool</span> <span>&#45;&gt;</span> <span>?&#8288;max_upload_size:int</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="index.html#type-config">config</a></code></dt><dd><p>Build a config from <a href="index.html#val-default_config"><code>default_config</code></a>.</p><dl><dt>since</dt><dd>0.12</dd></dl></dd></dl><dl><dt class="spec value" id="val-add_dir_path"><a href="#val-add_dir_path" class="anchor"></a><code><span class="keyword">val</span> add_dir_path : <span>config:<a href="index.html#type-config">config</a></span> <span>&#45;&gt;</span> <span>dir:string</span> <span>&#45;&gt;</span> <span>prefix:string</span> <span>&#45;&gt;</span> <a href="../Tiny_httpd_server/index.html#type-t">Tiny_httpd_server.t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>add_dirpath ~config ~dir ~prefix server</code> adds route handle to the <code>server</code> to serve static files in <code>dir</code> when url starts with <code>prefix</code>, using the given configuration <code>config</code>.</p></dd></dl><dl><dt class="spec module-type" id="module-type-VFS"><a href="#module-type-VFS" class="anchor"></a><code><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-VFS/index.html">VFS</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Virtual file system.</p></dd></dl><dl><dt class="spec value" id="val-vfs_of_dir"><a href="#val-vfs_of_dir" class="anchor"></a><code><span class="keyword">val</span> vfs_of_dir : string <span>&#45;&gt;</span> <span>(<span class="keyword">module</span> <a href="module-type-VFS/index.html">VFS</a>)</span></code></dt><dd><p><code>vfs_of_dir dir</code> makes a virtual file system that reads from the disk.</p><dl><dt>since</dt><dd>0.12</dd></dl></dd></dl><dl><dt class="spec value" id="val-add_vfs"><a href="#val-add_vfs" class="anchor"></a><code><span class="keyword">val</span> add_vfs : <span>config:<a href="index.html#type-config">config</a></span> <span>&#45;&gt;</span> <span>vfs:<span>(<span class="keyword">module</span> <a href="module-type-VFS/index.html">VFS</a>)</span></span> <span>&#45;&gt;</span> <span>prefix:string</span> <span>&#45;&gt;</span> <a href="../Tiny_httpd_server/index.html#type-t">Tiny_httpd_server.t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Similar to <a href="index.html#val-add_dir_path"><code>add_dir_path</code></a> but using a virtual file system instead.</p><dl><dt>since</dt><dd>0.12</dd></dl></dd></dl><dl><dt class="spec module" id="module-Embedded_fs"><a href="#module-Embedded_fs" class="anchor"></a><code><span class="keyword">module</span> <a href="Embedded_fs/index.html">Embedded_fs</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>An embedded file system, as a list of files with (relative) paths. This is useful in combination with the &quot;tiny-httpd-mkfs&quot; tool, which embeds the files it's given into a OCaml module.</p></dd></dl></div></body></html>